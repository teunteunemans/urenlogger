# Codebase Structure

**Analysis Date:** 2026-02-03

## Directory Layout

```
urenlogger/
├── src/                          # TypeScript source code
│   ├── commands/                 # Discord slash command handlers
│   ├── utils/                    # Utility functions and services
│   ├── config/                   # Configuration constants
│   ├── i18n/                     # Internationalization (Dutch)
│   ├── index.ts                  # Main bot entry point
│   ├── deploy-commands.ts        # Discord command registration
│   └── types.ts                  # TypeScript interfaces
├── dist/                         # Compiled JavaScript output
├── .github/                      # GitHub Actions workflows
├── Dockerfile                    # Container definition
├── docker-compose.yml            # Service orchestration
├── build.sh                      # Build automation
├── package.json                  # Project manifest
├── tsconfig.json                 # TypeScript config
├── .env.example                  # Environment template
└── README.md                     # Project documentation
```

## Directory Purposes

**src/commands/**
- Purpose: Discord slash command implementations
- Contains: One file per command, each exporting `data` and `execute`
- Key files:
  - `registreer.ts` - User registration
  - `log.ts` - Log work hours
  - `wijzig.ts` - Edit logged hours
  - `verwijder.ts` - Delete logged hours
  - `uren.ts` - View hours (current period or specific month)
  - `email.ts` - Email management (set, remove, show)

**src/utils/**
- Purpose: Shared utility functions and service layer
- Contains: Firebase operations, email generation, date parsing, validation
- Key files:
  - `firebaseService.ts` - All Firestore CRUD operations
  - `email.ts` - Monthly report generation and SMTP sending
  - `dateParser.ts` - Flexible date parsing with Dutch locale
  - `envValidator.ts` - Environment variable validation

**src/config/**
- Purpose: Application constants and configuration
- Contains: `constants.ts` - Billing period config, Dutch month mappings, env var lists, Discord limits

**src/i18n/**
- Purpose: Localization strings
- Contains: `nl.ts` - All Dutch user-facing messages and command descriptions

**dist/**
- Purpose: Compiled JavaScript output
- Source: Generated by `tsc` from `src/`
- Committed: Partially (in git history), should be gitignored

## Key File Locations

**Entry Points:**
- `src/index.ts` - Main bot application (client setup, event handling, cron)
- `src/deploy-commands.ts` - Slash command registration with Discord API

**Configuration:**
- `tsconfig.json` - TypeScript compiler options (strict, ES2020, CommonJS)
- `.env.example` - Environment variable template
- `src/config/constants.ts` - Application constants
- `Dockerfile` - Container definition
- `docker-compose.yml` - Service orchestration

**Core Logic:**
- `src/utils/firebaseService.ts` - Database operations (users + hour_logs)
- `src/utils/email.ts` - Email report generation and sending
- `src/utils/dateParser.ts` - Date parsing with Dutch support
- `src/commands/*.ts` - Command handlers

**Testing:**
- No test files or test configuration exist

**Documentation:**
- `README.md` - Project overview, setup, deployment guide

## Naming Conventions

**Files:**
- camelCase.ts for utility/service files (`firebaseService.ts`, `dateParser.ts`, `envValidator.ts`)
- lowercase for command files matching Discord command names (`registreer.ts`, `log.ts`, `wijzig.ts`)
- lowercase for single-word files (`email.ts`, `types.ts`)

**Directories:**
- lowercase for all directories (`commands/`, `utils/`, `config/`, `i18n/`)
- plural for collections (`commands/`, `utils/`)

**Special Patterns:**
- `index.ts` as main entry point
- `types.ts` for shared type definitions
- `.ts` extension for all source files

## Where to Add New Code

**New Discord Command:**
- Implementation: `src/commands/{command-name}.ts`
- Register in: `src/index.ts` (add to commands Collection)
- Deploy: Add to `src/deploy-commands.ts`
- Messages: Add to `src/i18n/nl.ts`

**New Utility/Service:**
- Implementation: `src/utils/{name}.ts`
- Types: Add interfaces to `src/types.ts`

**New Configuration:**
- Constants: `src/config/constants.ts`
- Environment vars: Add to `.env.example` and `src/utils/envValidator.ts`

## Special Directories

**dist/**
- Purpose: Compiled JavaScript output
- Source: Auto-generated by TypeScript compiler
- Committed: Should be gitignored (production builds via Docker)

**.github/**
- Purpose: GitHub Actions CI/CD workflows
- Committed: Yes

---

*Structure analysis: 2026-02-03*
*Update when directory structure changes*
